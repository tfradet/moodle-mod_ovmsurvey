{"version":3,"sources":["../src/tick_action.js"],"names":["define","$","ajax","notification","TickAction","selector","status","surveyId","total","_region","_status","_surveyid","_totalStmts","find","unbind","on","_setUserChoice","bind","prototype","element","elem","target","stmtid","data","value","localStorage","getItem","call","methodname","args","surveyid","done","parent","removeClass","addClass","activeReviewButton","fail","exception"],"mappings":"AAAAA,OAAM,6BAAC,CAAC,QAAD,CAAW,WAAX,CAAwB,mBAAxB,CAAD,CACN,SAASC,CAAT,CAAYC,CAAZ,CAAkBC,CAAlB,CAAgC,CAE5B,GAAIC,CAAAA,CAAU,CAAG,SAASC,CAAT,CAAmBC,CAAnB,CAA2BC,CAA3B,CAAqCC,CAArC,CAA4C,CACzD,KAAKC,OAAL,CAAeR,CAAC,CAACI,CAAD,CAAhB,CACA,KAAKK,OAAL,CAAeJ,CAAf,CACA,KAAKK,SAAL,CAAiBJ,CAAjB,CACA,KAAKK,WAAL,CAAmBJ,CAAnB,CAEA,KAAKC,OAAL,CAAaI,IAAb,CAAkB,kBAAlB,EAAsCC,MAAtC,GAA+CC,EAA/C,CAAkD,OAAlD,CAA2D,QAA3D,CAAqE,KAAKC,cAAL,CAAoBC,IAApB,CAAyB,IAAzB,CAArE,CACH,CAPD,CASAb,CAAU,CAACc,SAAX,CAAqBF,cAArB,CAAsC,SAASG,CAAT,CAAkB,IAChDC,CAAAA,CAAI,CAAGnB,CAAC,CAACkB,CAAO,CAACE,MAAT,CADwC,CAEhDC,CAAM,CAAGF,CAAI,CAACG,IAAL,CAAU,IAAV,CAFuC,CAGhDC,CAAK,CAAGJ,CAAI,CAACG,IAAL,CAAU,OAAV,CAHwC,CAIhDjB,CAAM,CAAG,KAAKI,OAAL,CAAe,KAAKA,OAApB,CAA8Be,YAAY,CAACC,OAAb,CAAqB,aAArB,CAJS,CAMpD,GAAc,EAAV,EAAAJ,CAAM,EAAmB,EAAT,EAAAE,CAApB,CAAiC,CAC7BtB,CAAI,CAACyB,IAAL,CAAU,CAAC,CACPC,UAAU,CAAE,0BADL,CAEPC,IAAI,CAAE,CACFC,QAAQ,CAAE,KAAKnB,SADb,CAEFL,MAAM,CAAEA,CAAM,CAAGA,CAAH,CAAY,EAFxB,CAGFgB,MAAM,CAAEA,CAHN,CAIFE,KAAK,CAAEA,CAJL,CAFC,CAQPO,IAAI,CAAE,SAASR,CAAT,CAAe,CACjBtB,CAAC,CAACkB,CAAO,CAACE,MAAT,CAAD,CAAkBW,MAAlB,GAA2BnB,IAA3B,CAAgC,QAAhC,EAA0CoB,WAA1C,CAAsD,QAAtD,EACAhC,CAAC,CAACkB,CAAO,CAACE,MAAT,CAAD,CAAkBa,QAAlB,CAA2B,QAA3B,EACAjC,CAAC,CAACkB,CAAO,CAACE,MAAT,CAAD,CAAkBW,MAAlB,GAA2BA,MAA3B,GAAoCA,MAApC,GAA6CA,MAA7C,GAAsDA,MAAtD,GAA+DnB,IAA/D,CAAoE,YAApE,EAAkFoB,WAAlF,CAA8F,QAA9F,EAEA,GAAI,KAAKrB,WAAL,EAAoBW,CAAxB,CAA8B,CAC1B,KAAKY,kBAAL,EACH,CAED,QACH,CAVK,CAUJlB,IAVI,CAUC,IAVD,CARC,CAmBPmB,IAAI,CAAEjC,CAAY,CAACkC,SAnBZ,CAAD,CAAV,CAqBH,CACJ,CA7BD,CA+BAjC,CAAU,CAACc,SAAX,CAAqBiB,kBAArB,CAA0C,UAAW,CACjDlC,CAAC,CAAC,0BAAD,CAAD,CAA8BgC,WAA9B,CAA0C,UAA1C,EACAhC,CAAC,CAAC,wBAAD,CAAD,CAA4BgC,WAA5B,CAAwC,QAAxC,CACH,CAHD,CAKA,MAAO7B,CAAAA,CACV,CAjDK,CAAN","sourcesContent":["define(['jquery', 'core/ajax', 'core/notification'],\nfunction($, ajax, notification) {\n\n    var TickAction = function(selector, status, surveyId, total) {\n        this._region = $(selector);\n        this._status = status;\n        this._surveyid = surveyId;\n        this._totalStmts = total;\n\n        this._region.find('.ovm-option-list').unbind().on('click', 'button', this._setUserChoice.bind(this));\n    };\n\n    TickAction.prototype._setUserChoice = function(element) {\n        var elem = $(element.target);\n        var stmtid = elem.data('id');\n        var value = elem.data('value');\n        var status = this._status ? this._status : localStorage.getItem('ovms-status');\n\n        if (stmtid != \"\" && value != \"\") {\n            ajax.call([{\n                methodname: 'mod_ovmsurvey_set_answer',\n                args: {\n                    surveyid: this._surveyid,\n                    status: status ? status : '',\n                    stmtid: stmtid,\n                    value: value\n                },\n                done: function(data) {\n                    $(element.target).parent().find('button').removeClass('active');\n                    $(element.target).addClass('active');\n                    $(element.target).parent().parent().parent().parent().parent().find('.check-svg').removeClass('hidden');\n\n                    if (this._totalStmts == data) {\n                        this.activeReviewButton();\n                    }\n\n                    return true;\n                }.bind(this),\n                fail: notification.exception\n            }]);\n        }\n    };\n\n    TickAction.prototype.activeReviewButton = function() {\n        $('#ovmsurvey-review-button').removeClass(\"disabled\");\n        $('#ovmsurvey-review-link').removeClass(\"hidden\");\n    };\n\n    return TickAction;\n});"],"file":"tick_action.min.js"}